# ğŸš€ BinNav - EdgeOne Functions éƒ¨ç½²æŒ‡å—

## ğŸ“‹ EdgeOne Functions æ–¹æ¡ˆä»‹ç»

EdgeOne Functions æ˜¯åŸºäºEdgeOne Pagesçš„Serverlesså‡½æ•°æœåŠ¡ï¼Œå®Œç¾æ›¿ä»£GitHub Actionsï¼š

- âœ… **æ— éœ€GitHub Actions** - ç›´æ¥é€šè¿‡å‡½æ•°è°ƒç”¨GitHub API  
- âœ… **æ›´é«˜å®‰å…¨æ€§** - æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨EdgeOne Functionsç¯å¢ƒå˜é‡ä¸­
- âœ… **æ¶æ„æ›´ç®€æ´** - å»æ‰ä¸­é—´å±‚ï¼Œç›´æ¥æ“ä½œGitHubä»“åº“
- âœ… **å…¨çƒè¾¹ç¼˜è®¡ç®—** - è¶…ä½å»¶è¿ŸAPIå“åº”
- âœ… **ä¸€ä½“åŒ–ç®¡ç†** - é™æ€æ‰˜ç®¡+å‡½æ•°æœåŠ¡ç»Ÿä¸€åœ¨EdgeOneå¹³å°

## ğŸ—ï¸ æ¶æ„å¯¹æ¯”

### ä¼ ç»ŸGitHub Actionsæ–¹æ¡ˆï¼š
```
å‰ç«¯æ“ä½œ â†’ GitHub Actions API â†’ è§¦å‘å·¥ä½œæµ â†’ æ›´æ–°æ–‡ä»¶ â†’ EdgeOne Pagesé‡æ–°éƒ¨ç½²
```

### EdgeOne Functionsæ–¹æ¡ˆï¼š
```
å‰ç«¯æ“ä½œ â†’ EdgeOne Functions â†’ GitHub API â†’ ç›´æ¥æ›´æ–°æ–‡ä»¶ â†’ EdgeOne Pagesè‡ªåŠ¨é‡æ–°éƒ¨ç½²
```

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### ç¬¬1æ­¥ï¼šé¡¹ç›®ç»“æ„å‡†å¤‡

ç¡®ä¿é¡¹ç›®åŒ…å«ä»¥ä¸‹ç»“æ„ï¼š
```
binnav/
â”œâ”€â”€ src/                    # Reactå‰ç«¯ä»£ç 
â”œâ”€â”€ functions/              # EdgeOne Functionsä»£ç 
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ health.js       # å¥åº·æ£€æŸ¥
â”‚       â”œâ”€â”€ get-config.js   # è·å–é…ç½®
â”‚       â””â”€â”€ update-config.js # æ›´æ–°é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### ç¬¬2æ­¥ï¼šEdgeOne Pages éƒ¨ç½²

1. **ç™»å½•EdgeOneæ§åˆ¶å°**ï¼š
   ```
   https://console.cloud.tencent.com/edgeone
   ```

2. **åˆ›å»ºPagesé¡¹ç›®**ï¼š
   - é€‰æ‹©"ä»Gitä»“åº“å¯¼å…¥"
   - è¿æ¥GitHubä»“åº“
   - é€‰æ‹©`binnav`é¡¹ç›®

3. **é…ç½®æ„å»ºè®¾ç½®**ï¼š
   ```
   æ„å»ºå‘½ä»¤: npm run build
   è¾“å‡ºç›®å½•: dist
   Node.jsç‰ˆæœ¬: 18.x
   åˆ†æ”¯: main
   ```

### ç¬¬3æ­¥ï¼šé…ç½®EdgeOne Functionsç¯å¢ƒå˜é‡

åœ¨EdgeOneé¡¹ç›®è®¾ç½®ä¸­é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `GITHUB_TOKEN` | GitHub Personal Access Token | `ghp_1234567890...` |
| `GITHUB_REPO` | GitHubä»“åº“åç§° | `username/binnav` |
| `ADMIN_PASSWORD` | ç®¡ç†åå°å¯†ç  | `MySecurePassword123!` |
| `RESEND_API_KEY` | Resendé‚®ä»¶æœåŠ¡å¯†é’¥ | `re_1234567890...` |
| `ADMIN_EMAIL` | ç®¡ç†å‘˜é‚®ç®± | `admin@example.com` |
| `RESEND_FROM_DOMAIN` | Resendå‘é€åŸŸå | `noreply@yourdomain.com` |

#### åˆ›å»ºGitHub Tokenï¼š
1. è®¿é—® https://github.com/settings/tokens
2. ç‚¹å‡» "Generate new token (classic)"
3. é€‰æ‹©æƒé™ï¼šâœ… `repo` (ä»“åº“å®Œå…¨è®¿é—®)
4. å¤åˆ¶ç”Ÿæˆçš„Token

### ç¬¬4æ­¥ï¼šéªŒè¯Functionséƒ¨ç½²

1. **æ£€æŸ¥FunctionsçŠ¶æ€**ï¼š
   ```
   GET https://your-project.pages.dev/api/health
   ```
   
   æˆåŠŸå“åº”ç¤ºä¾‹ï¼š
   ```json
   {
     "status": "healthy",
     "service": "EdgeOne Functions",
     "config": {
       "hasGitHubToken": true,
       "hasGitHubRepo": true,
       "repoName": "username/binnav"  
     }
   }
   ```

2. **æµ‹è¯•é…ç½®è·å–**ï¼š
   ```
   GET https://your-project.pages.dev/api/get-config
   ```

### ç¬¬5æ­¥ï¼šæµ‹è¯•å®Œæ•´æµç¨‹

1. **è®¿é—®ç®¡ç†åå°**ï¼š
   ```
   https://your-project.pages.dev/admin
   ```

2. **ç™»å½•å¹¶æµ‹è¯•**ï¼š
   - ä½¿ç”¨é…ç½®çš„`ADMIN_PASSWORD`ç™»å½•
   - æ·»åŠ /ä¿®æ”¹ç½‘ç«™é…ç½®
   - ç‚¹å‡»"ä¿å­˜é…ç½®"æŒ‰é’®

3. **éªŒè¯è‡ªåŠ¨éƒ¨ç½²**ï¼š
   - æŸ¥çœ‹GitHubä»“åº“æ˜¯å¦æœ‰æ–°çš„commit
   - ç­‰å¾…1-2åˆ†é’Ÿï¼Œæ£€æŸ¥ç½‘ç«™æ˜¯å¦æ›´æ–°

## ğŸ“ Functionsä»£ç è¯´æ˜

### `/api/health.js` - å¥åº·æ£€æŸ¥
```javascript
// æ£€æŸ¥æœåŠ¡çŠ¶æ€å’Œé…ç½®
GET /api/health
```

### `/api/get-config.js` - è·å–é…ç½®
```javascript  
// è·å–å½“å‰websiteData.jsæ–‡ä»¶å†…å®¹
GET /api/get-config
```

### `/api/update-config.js` - æ›´æ–°é…ç½®
```javascript
// æ›´æ–°websiteData.jsæ–‡ä»¶
POST /api/update-config
{
  "config": "æ–‡ä»¶å†…å®¹",
  "sha": "å½“å‰æ–‡ä»¶SHAå€¼"
}
```

## ğŸ”’ å®‰å…¨ä¼˜åŠ¿

### ä¸ä¼ ç»Ÿæ–¹æ¡ˆå¯¹æ¯”ï¼š

| å®‰å…¨é¡¹ç›® | GitHub Actions | EdgeOne Functions |
|----------|----------------|-------------------|
| æ•æ„Ÿä¿¡æ¯å­˜å‚¨ | GitHub Secrets | EdgeOneç¯å¢ƒå˜é‡ |
| å‰ç«¯è®¿é—®æƒé™ | éœ€è¦æš´éœ²è§¦å‘API | å®Œå…¨éš”ç¦» |
| Tokenæ³„éœ²é£é™© | ä¸­ç­‰ | æä½ |
| æƒé™æ§åˆ¶ | Actionsæƒé™ | Functionsæƒé™ |

### å®‰å…¨ç‰¹æ€§ï¼š
- âœ… **æœåŠ¡ç«¯éš”ç¦»**ï¼šGitHub Tokenå®Œå…¨åœ¨EdgeOne Functionsä¸­å¤„ç†
- âœ… **å‰ç«¯æ— æƒé™**ï¼šå‰ç«¯é¡µé¢æ— æ³•ç›´æ¥è®¿é—®GitHub API
- âœ… **æœ€å°æƒé™**ï¼šåªéœ€è¦`repo`æƒé™ï¼Œæ— éœ€Actionsæƒé™
- âœ… **è¾¹ç¼˜å®‰å…¨**ï¼šå…¨çƒåˆ†å¸ƒå¼æ‰§è¡Œï¼Œé™ä½å•ç‚¹é£é™©

## ğŸš€ æ€§èƒ½ä¼˜åŠ¿

### å“åº”æ—¶é—´å¯¹æ¯”ï¼š

| æ“ä½œ | GitHub Actionsæ–¹æ¡ˆ | EdgeOne Functionsæ–¹æ¡ˆ |
|------|-------------------|----------------------|
| é…ç½®æ›´æ–°è§¦å‘ | 5-10ç§’ | 0.1-0.5ç§’ |
| GitHub APIè°ƒç”¨ | 2-5ç§’ | 0.2-1ç§’ |
| æ€»ä½“å“åº”æ—¶é—´ | 7-15ç§’ | 0.3-1.5ç§’ |

### æ€§èƒ½ç‰¹æ€§ï¼š
- âš¡ **è¾¹ç¼˜è®¡ç®—**ï¼šå…¨çƒ3200+ EdgeOneèŠ‚ç‚¹å°±è¿‘æ‰§è¡Œ
- âš¡ **æ— å†·å¯åŠ¨**ï¼šFunctionså¸¸é©»å†…å­˜ï¼Œå“åº”æ›´å¿«
- âš¡ **ç›´æ¥è°ƒç”¨**ï¼šå‡å°‘ä¸­é—´ç¯èŠ‚ï¼Œé™ä½å»¶è¿Ÿ
- âš¡ **å¹¶å‘å¤„ç†**ï¼šæ”¯æŒé«˜å¹¶å‘æ“ä½œ

## ğŸ’° æˆæœ¬ä¼˜åŠ¿

### è´¹ç”¨å¯¹æ¯”ï¼š

| æœåŠ¡ | GitHub Actions | EdgeOne Functions |
|------|----------------|-------------------|
| åŸºç¡€è´¹ç”¨ | å…è´¹2000åˆ†é’Ÿ/æœˆ | å…è´¹ï¼ˆå…¬æµ‹æœŸï¼‰ |
| è¶…é¢è´¹ç”¨ | $0.008/åˆ†é’Ÿ | å¾…å…¬å¸ƒ |
| ä¾èµ–æœåŠ¡ | æ—  | æ—  |

### æˆæœ¬ç‰¹æ€§ï¼š
- ğŸ’° **å…è´¹ä½¿ç”¨**ï¼šå…¬æµ‹æœŸé—´å®Œå…¨å…è´¹
- ğŸ’° **æŒ‰éœ€è®¡è´¹**ï¼šåªä¸ºå®é™…ä½¿ç”¨ä»˜è´¹
- ğŸ’° **æ— éšè—è´¹ç”¨**ï¼šä¸€ä½“åŒ–å¹³å°ï¼Œæ— é¢å¤–æˆæœ¬

## ğŸ”„ è¿ç§»æŒ‡å—

### ä»GitHub Actionsè¿ç§»ï¼š

1. **å¤‡ä»½ç°æœ‰é…ç½®**ï¼š
   ```bash
   # å¤‡ä»½GitHub Actionsé…ç½®
   cp -r .github/workflows/ .github/workflows.backup/
   ```

2. **åˆ›å»ºFunctionsä»£ç **ï¼š
   - åˆ›å»º`functions/`ç›®å½•
   - æ·»åŠ APIç«¯ç‚¹æ–‡ä»¶

3. **ä¿®æ”¹å‰ç«¯è°ƒç”¨**ï¼š
   - æ›´æ–°`src/pages/Admin.jsx`
   - ä¿®æ”¹APIè°ƒç”¨åœ°å€

4. **é…ç½®ç¯å¢ƒå˜é‡**ï¼š
   - ä»GitHub Secretsè¿ç§»åˆ°EdgeOneç¯å¢ƒå˜é‡

5. **æµ‹è¯•éªŒè¯**ï¼š
   - éªŒè¯Functionsæ­£å¸¸å·¥ä½œ
   - æµ‹è¯•å®Œæ•´æ›´æ–°æµç¨‹

6. **æ¸…ç†æ—§é…ç½®**ï¼š
   ```bash
   # åˆ é™¤GitHub Actionsé…ç½®ï¼ˆå¯é€‰ï¼‰
   rm -rf .github/workflows/
   ```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜1ï¼šFunctionséƒ¨ç½²å¤±è´¥

**ç—‡çŠ¶**ï¼šè®¿é—®`/api/health`è¿”å›404

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥`functions/`ç›®å½•ç»“æ„æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ–‡ä»¶åå’Œå¯¼å‡ºå‡½æ•°åç§°æ­£ç¡®
3. æ£€æŸ¥EdgeOne Pagesæ˜¯å¦å¯ç”¨äº†FunctionsåŠŸèƒ½

### å¸¸è§é—®é¢˜2ï¼šGitHub APIè°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**ï¼šä¿å­˜é…ç½®æ—¶æç¤ºGitHub APIé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥`GITHUB_TOKEN`ç¯å¢ƒå˜é‡æ˜¯å¦é…ç½®
2. éªŒè¯Tokenæƒé™æ˜¯å¦åŒ…å«`repo`
3. ç¡®è®¤`GITHUB_REPO`æ ¼å¼ä¸º`username/repository`

### å¸¸è§é—®é¢˜3ï¼šé…ç½®æ›´æ–°ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šä¿å­˜æˆåŠŸä½†ç½‘ç«™å†…å®¹æœªæ›´æ–°

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥GitHubä»“åº“æ˜¯å¦æœ‰æ–°çš„commit
2. ç­‰å¾…EdgeOne Pagesè‡ªåŠ¨é‡æ–°éƒ¨ç½²ï¼ˆ1-2åˆ†é’Ÿï¼‰
3. æ£€æŸ¥æ„å»ºæ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯

### å¸¸è§é—®é¢˜4ï¼šCORSé”™è¯¯

**ç—‡çŠ¶**ï¼šå‰ç«¯è°ƒç”¨APIæ—¶å‡ºç°è·¨åŸŸé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤Functionsä¸­å·²æ·»åŠ CORSå¤´
2. æ£€æŸ¥OPTIONSè¯·æ±‚å¤„ç†æ˜¯å¦æ­£ç¡®
3. éªŒè¯`Access-Control-Allow-Origin`è®¾ç½®

## ğŸ“Š ç›‘æ§å’Œè°ƒè¯•

### 1. Functionsæ—¥å¿—

åœ¨EdgeOneæ§åˆ¶å°æŸ¥çœ‹Functionsæ‰§è¡Œæ—¥å¿—ï¼š
```
EdgeOneæ§åˆ¶å° â†’ Pages â†’ é¡¹ç›®å â†’ Functions â†’ æ—¥å¿—
```

### 2. æ€§èƒ½ç›‘æ§

ç›‘æ§APIå“åº”æ—¶é—´å’ŒæˆåŠŸç‡ï¼š
```
EdgeOneæ§åˆ¶å° â†’ Pages â†’ é¡¹ç›®å â†’ Functions â†’ ç›‘æ§
```

### 3. è°ƒè¯•æŠ€å·§

å¼€å¯è°ƒè¯•æ¨¡å¼ï¼š
```javascript
// åœ¨Functionsä¸­æ·»åŠ è¯¦ç»†æ—¥å¿—
console.log('Request data:', requestData);
console.log('GitHub response:', response.status);
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š
- [ ] âœ… EdgeOne Pagesé¡¹ç›®å·²åˆ›å»º
- [ ] âœ… Functionsç›®å½•ç»“æ„æ­£ç¡®
- [ ] âœ… ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆ6ä¸ªï¼‰
- [ ] âœ… GitHub Tokenæƒé™æ­£ç¡®
- [ ] âœ… æœ¬åœ°æ„å»ºæµ‹è¯•é€šè¿‡
- [ ] âœ… Functionså¥åº·æ£€æŸ¥é€šè¿‡
- [ ] âœ… ç®¡ç†åå°ç™»å½•æˆåŠŸ
- [ ] âœ… é…ç½®æ›´æ–°æµç¨‹æµ‹è¯•é€šè¿‡

## ğŸ‰ å®Œæˆï¼

ç°åœ¨æ‚¨çš„BinNavå¯¼èˆªç½‘ç«™å·²å‡çº§åˆ°EdgeOne Functionsæ–¹æ¡ˆï¼

### æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“ï¼š
- ğŸš€ **æ€§èƒ½æå‡**ï¼šå“åº”æ—¶é—´å‡å°‘80%ä»¥ä¸Š
- ğŸ”’ **å®‰å…¨åŠ å¼º**ï¼šæ•æ„Ÿä¿¡æ¯å®Œå…¨æœåŠ¡ç«¯åŒ–
- ğŸ—ï¸ **æ¶æ„ç®€åŒ–**ï¼šå»æ‰GitHub Actionsä¸­é—´å±‚
- ğŸ’° **æˆæœ¬é™ä½**ï¼šä¸€ä½“åŒ–å¹³å°ï¼Œå‡å°‘è´¹ç”¨
- ğŸŒ **å…¨çƒåŠ é€Ÿ**ï¼šEdgeOneè¾¹ç¼˜ç½‘ç»œè¦†ç›–

### è®¿é—®åœ°å€ï¼š
- **ç½‘ç«™é¦–é¡µ**ï¼š`https://your-project.pages.dev`
- **ç®¡ç†åå°**ï¼š`https://your-project.pages.dev/admin`
- **å¥åº·æ£€æŸ¥**ï¼š`https://your-project.pages.dev/api/health`

---

*EdgeOne Functions - ä¸ºç°ä»£åŒ–Webåº”ç”¨æä¾›æè‡´æ€§èƒ½çš„Serverlessè§£å†³æ–¹æ¡ˆ* 